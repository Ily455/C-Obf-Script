#endif






 
 
 
 
 






 
 
 
 






#endif






 
 
 
 
 






 
 
 
 






#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca) && (qoksagvcqlca == 1)
#elif csdhdqatyzqa(xaemkjmmttlf) && (xaemkjmmttlf == 1)
#else



#endif






 
 
 
 
 






 
 
 
 






#if (csdhdqatyzqa(CBC) && (CBC == 1)) || (csdhdqatyzqa(CTR) && (CTR == 1))
#endif






 
 
 
 
 






 
 
 
 






#if (csdhdqatyzqa(CBC) && (CBC == 1)) || (csdhdqatyzqa(CTR) && (CTR == 1))
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(ECB) && (ECB == 1)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(CBC) && (CBC == 1)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(CTR) && (CTR == 1)
#endif






 
 
 
 
 






 
 
 
 






#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca) && (qoksagvcqlca == 1)
#elif csdhdqatyzqa(xaemkjmmttlf) && (xaemkjmmttlf == 1)
#else



#endif






 
 
 
 
 






 
 
 
 






#endif






 
 
 
 
 






 
 
 
 






#if (csdhdqatyzqa(CBC) && CBC == 1) || (csdhdqatyzqa(ECB) && ECB == 1)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca) && (qoksagvcqlca == 1)
#endif






 
 
 
 
 






 
 
 
 






#if (csdhdqatyzqa(CBC) && (CBC == 1)) || (csdhdqatyzqa(CTR) && (CTR == 1))
#endif






 
 
 
 
 






 
 
 
 






#if wciuclhbxtbq
#else



#endif






 
 
 
 
 






 
 
 
 






#if (csdhdqatyzqa(CBC) && CBC == 1) || (csdhdqatyzqa(ECB) && ECB == 1)
#endif






 
 
 
 
 






 
 
 
 






#if (csdhdqatyzqa(CBC) && CBC == 1) || (csdhdqatyzqa(ECB) && ECB == 1)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(ECB) && (ECB == 1)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(CBC) && (CBC == 1)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(CTR) && (CTR == 1)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca)
#elif csdhdqatyzqa(xaemkjmmttlf)
#elif csdhdqatyzqa(tckcirkvyavt)
#else



#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca)
#elif csdhdqatyzqa(xaemkjmmttlf)
#elif csdhdqatyzqa(tckcirkvyavt)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca)
#elif csdhdqatyzqa(xaemkjmmttlf)
#elif csdhdqatyzqa(tckcirkvyavt)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca)
#elif csdhdqatyzqa(xaemkjmmttlf)
#elif csdhdqatyzqa(tckcirkvyavt)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca)
#elif csdhdqatyzqa(xaemkjmmttlf)
#elif csdhdqatyzqa(tckcirkvyavt)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca)
#elif csdhdqatyzqa(xaemkjmmttlf)
#elif csdhdqatyzqa(tckcirkvyavt)
#endif






 
 
 
 
 






 
 
 
 






#if csdhdqatyzqa(qoksagvcqlca)
#elif csdhdqatyzqa(xaemkjmmttlf)
#elif csdhdqatyzqa(tckcirkvyavt)
#endif






 
 
 
 
 






 
 
 
 






txfzotnamtvv aznjrtivdrap{ynbfgvseoifh xrhogxwtkorl[AES_keyExpSize];ynbfgvseoifh rkuevisewziu[AES_BLOCKLEN];};tilwtnjqlmpj iwpampcitene(txfzotnamtvv aznjrtivdrap*ctx,fduzkjwuepxb ynbfgvseoifh*bmthdpwqpqtg);tilwtnjqlmpj cgavlbeeebwq(txfzotnamtvv aznjrtivdrap*ctx,fduzkjwuepxb ynbfgvseoifh*bmthdpwqpqtg,fduzkjwuepxb ynbfgvseoifh*dmkbvkkwfkey);tilwtnjqlmpj jaigkheroaxb(txfzotnamtvv aznjrtivdrap*ctx,fduzkjwuepxb ynbfgvseoifh*dmkbvkkwfkey);tilwtnjqlmpj bixmmhgzrbwg(fduzkjwuepxb txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf);tilwtnjqlmpj ahcvqetihscp(fduzkjwuepxb txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf);tilwtnjqlmpj zxtrmgbcsuyt(txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf,size_t wdgxpizmsvfi);tilwtnjqlmpj bcrzbzvutygj(txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf,size_t wdgxpizmsvfi);tilwtnjqlmpj anbtbfxxeqhi(txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf,size_t wdgxpizmsvfi);typedef ynbfgvseoifhstate_t[4][4];static fduzkjwuepxb ynbfgvseoifh gidraullzwii[256]={0x63,0x7c,0x77,0x7b,0xf2,0x6b,0x6f,0xc5,0x30,0x01,0x67,0x2b,0xfe,0xd7,0xab,0x76,0xca,0x82,0xc9,0x7d,0xfa,0x59,0x47,0xf0,0xad,0xd4,0xa2,0xaf,0x9c,0xa4,0x72,0xc0,0xb7,0xfd,0x93,0x26,0x36,0x3f,0xf7,0xcc,0x34,0xa5,0xe5,0xf1,0x71,0xd8,0x31,0x15,0x04,0xc7,0x23,0xc3,0x18,0x96,0x05,0x9a,0x07,0x12,0x80,0xe2,0xeb,0x27,0xb2,0x75,0x09,0x83,0x2c,0x1a,0x1b,0x6e,0x5a,0xa0,0x52,0x3b,0xd6,0xb3,0x29,0xe3,0x2f,0x84,0x53,0xd1,0x00,0xed,0x20,0xfc,0xb1,0x5b,0x6a,0xcb,0xbe,0x39,0x4a,0x4c,0x58,0xcf,0xd0,0xef,0xaa,0xfb,0x43,0x4d,0x33,0x85,0x45,0xf9,0x02,0x7f,0x50,0x3c,0x9f,0xa8,0x51,0xa3,0x40,0x8f,0x92,0x9d,0x38,0xf5,0xbc,0xb6,0xda,0x21,0x10,0xff,0xf3,0xd2,0xcd,0x0c,0x13,0xec,0x5f,0x97,0x44,0x17,0xc4,0xa7,0x7e,0x3d,0x64,0x5d,0x19,0x73,0x60,0x81,0x4f,0xdc,0x22,0x2a,0x90,0x88,0x46,0xee,0xb8,0x14,0xde,0x5e,0x0b,0xdb,0xe0,0x32,0x3a,0x0a,0x49,0x06,0x24,0x5c,0xc2,0xd3,0xac,0x62,0x91,0x95,0xe4,0x79,0xe7,0xc8,0x37,0x6d,0x8d,0xd5,0x4e,0xa9,0x6c,0x56,0xf4,0xea,0x65,0x7a,0xae,0x08,0xba,0x78,0x25,0x2e,0x1c,0xa6,0xb4,0xc6,0xe8,0xdd,0x74,0x1f,0x4b,0xbd,0x8b,0x8a,0x70,0x3e,0xb5,0x66,0x48,0x03,0xf6,0x0e,0x61,0x35,0x57,0xb9,0x86,0xc1,0x1d,0x9e,0xe1,0xf8,0x98,0x11,0x69,0xd9,0x8e,0x94,0x9b,0x1e,0x87,0xe9,0xce,0x55,0x28,0xdf,0x8c,0xa1,0x89,0x0d,0xbf,0xe6,0x42,0x68,0x41,0x99,0x2d,0x0f,0xb0,0x54,0xbb,0x16};static fduzkjwuepxb ynbfgvseoifh qamvngioeuwc[256]={0x52,0x09,0x6a,0xd5,0x30,0x36,0xa5,0x38,0xbf,0x40,0xa3,0x9e,0x81,0xf3,0xd7,0xfb,0x7c,0xe3,0x39,0x82,0x9b,0x2f,0xff,0x87,0x34,0x8e,0x43,0x44,0xc4,0xde,0xe9,0xcb,0x54,0x7b,0x94,0x32,0xa6,0xc2,0x23,0x3d,0xee,0x4c,0x95,0x0b,0x42,0xfa,0xc3,0x4e,0x08,0x2e,0xa1,0x66,0x28,0xd9,0x24,0xb2,0x76,0x5b,0xa2,0x49,0x6d,0x8b,0xd1,0x25,0x72,0xf8,0xf6,0x64,0x86,0x68,0x98,0x16,0xd4,0xa4,0x5c,0xcc,0x5d,0x65,0xb6,0x92,0x6c,0x70,0x48,0x50,0xfd,0xed,0xb9,0xda,0x5e,0x15,0x46,0x57,0xa7,0x8d,0x9d,0x84,0x90,0xd8,0xab,0x00,0x8c,0xbc,0xd3,0x0a,0xf7,0xe4,0x58,0x05,0xb8,0xb3,0x45,0x06,0xd0,0x2c,0x1e,0x8f,0xca,0x3f,0x0f,0x02,0xc1,0xaf,0xbd,0x03,0x01,0x13,0x8a,0x6b,0x3a,0x91,0x11,0x41,0x4f,0x67,0xdc,0xea,0x97,0xf2,0xcf,0xce,0xf0,0xb4,0xe6,0x73,0x96,0xac,0x74,0x22,0xe7,0xad,0x35,0x85,0xe2,0xf9,0x37,0xe8,0x1c,0x75,0xdf,0x6e,0x47,0xf1,0x1a,0x71,0x1d,0x29,0xc5,0x89,0x6f,0xb7,0x62,0x0e,0xaa,0x18,0xbe,0x1b,0xfc,0x56,0x3e,0x4b,0xc6,0xd2,0x79,0x20,0x9a,0xdb,0xc0,0xfe,0x78,0xcd,0x5a,0xf4,0x1f,0xdd,0xa8,0x33,0x88,0x07,0xc7,0x31,0xb1,0x12,0x10,0x59,0x27,0x80,0xec,0x5f,0x60,0x51,0x7f,0xa9,0x19,0xb5,0x4a,0x0d,0x2d,0xe5,0x7a,0x9f,0x93,0xc9,0x9c,0xef,0xa0,0xe0,0x3b,0x4d,0xae,0x2a,0xf5,0xb0,0xc8,0xeb,0xbb,0x3c,0x83,0x53,0x99,0x61,0x17,0x2b,0x04,0x7e,0xba,0x77,0xd6,0x26,0xe1,0x69,0x14,0x63,0x55,0x21,0x0c,0x7d};static fduzkjwuepxb ynbfgvseoifh xihxrjxcgtbr[11]={0x8d,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80,0x1b,0x36};static tilwtnjqlmpjKeyExpansion(ynbfgvseoifh*xrhogxwtkorl,fduzkjwuepxb ynbfgvseoifh*Key){unsigned fhpedpfojlje ,j,k;ynbfgvseoifh xmazspbpctyt[4];for(fhpedpfojlje=0;fhpedpfojlje<Nk;++fhpedpfojlje){xrhogxwtkorl[(fhpedpfojlje *4)+0]=Key[(fhpedpfojlje *4)+0];xrhogxwtkorl[(fhpedpfojlje *4)+1]=Key[(fhpedpfojlje *4)+1];xrhogxwtkorl[(fhpedpfojlje *4)+2]=Key[(fhpedpfojlje *4)+2];xrhogxwtkorl[(fhpedpfojlje *4)+3]=Key[(fhpedpfojlje *4)+3];}for(fhpedpfojlje=Nk;fhpedpfojlje<Nb *(Nr+1);++fhpedpfojlje){{k=(fhpedpfojlje-1)*4;xmazspbpctyt[0]=xrhogxwtkorl[k+0];xmazspbpctyt[1]=xrhogxwtkorl[k+1];xmazspbpctyt[2]=xrhogxwtkorl[k+2];xmazspbpctyt[3]=xrhogxwtkorl[k+3];}if(fhpedpfojlje%Nk==0){{fduzkjwuepxb ynbfgvseoifhu8tmp=xmazspbpctyt[0];xmazspbpctyt[0]=xmazspbpctyt[1];xmazspbpctyt[1]=xmazspbpctyt[2];xmazspbpctyt[2]=xmazspbpctyt[3];xmazspbpctyt[3]=u8tmp;}{xmazspbpctyt[0]=getSBoxValue(xmazspbpctyt[0]);xmazspbpctyt[1]=getSBoxValue(xmazspbpctyt[1]);xmazspbpctyt[2]=getSBoxValue(xmazspbpctyt[2]);xmazspbpctyt[3]=getSBoxValue(xmazspbpctyt[3]);}xmazspbpctyt[0]=xmazspbpctyt[0]^xihxrjxcgtbr[fhpedpfojlje/Nk];}if(fhpedpfojlje%Nk==4){{xmazspbpctyt[0]=getSBoxValue(xmazspbpctyt[0]);xmazspbpctyt[1]=getSBoxValue(xmazspbpctyt[1]);xmazspbpctyt[2]=getSBoxValue(xmazspbpctyt[2]);xmazspbpctyt[3]=getSBoxValue(xmazspbpctyt[3]);}}j=fhpedpfojlje *4;k=(fhpedpfojlje-Nk)*4;xrhogxwtkorl[j+0]=xrhogxwtkorl[k+0]^xmazspbpctyt[0];xrhogxwtkorl[j+1]=xrhogxwtkorl[k+1]^xmazspbpctyt[1];xrhogxwtkorl[j+2]=xrhogxwtkorl[k+2]^xmazspbpctyt[2];xrhogxwtkorl[j+3]=xrhogxwtkorl[k+3]^xmazspbpctyt[3];}}tilwtnjqlmpj iwpampcitene(txfzotnamtvv aznjrtivdrap*ctx,fduzkjwuepxb ynbfgvseoifh*bmthdpwqpqtg){KeyExpansion(ctx->xrhogxwtkorl,bmthdpwqpqtg);}tilwtnjqlmpj cgavlbeeebwq(txfzotnamtvv aznjrtivdrap*ctx,fduzkjwuepxb ynbfgvseoifh*bmthdpwqpqtg,fduzkjwuepxb ynbfgvseoifh*dmkbvkkwfkey){KeyExpansion(ctx->xrhogxwtkorl,bmthdpwqpqtg);memcpy(ctx->rkuevisewziu,dmkbvkkwfkey,AES_BLOCKLEN);}tilwtnjqlmpj jaigkheroaxb(txfzotnamtvv aznjrtivdrap*ctx,fduzkjwuepxb ynbfgvseoifh*dmkbvkkwfkey){memcpy(ctx->rkuevisewziu,dmkbvkkwfkey,AES_BLOCKLEN);}static tilwtnjqlmpjAddRoundKey(ynbfgvseoifh spnrrpqfpmtb,state_t*state,fduzkjwuepxb ynbfgvseoifh*xrhogxwtkorl){ynbfgvseoifh fhpedpfojlje,j;for(fhpedpfojlje=0;fhpedpfojlje<4;++fhpedpfojlje){for(j=0;j<4;++j){(*state)[fhpedpfojlje][j]^=xrhogxwtkorl[(spnrrpqfpmtb *Nb *4)+(fhpedpfojlje *Nb)+j];}}}static tilwtnjqlmpjSubBytes(state_t*state){ynbfgvseoifh fhpedpfojlje,j;for(fhpedpfojlje=0;fhpedpfojlje<4;++fhpedpfojlje){for(j=0;j<4;++j){(*state)[j][fhpedpfojlje]=getSBoxValue((*state)[j][fhpedpfojlje]);}}}static tilwtnjqlmpjShiftRows(state_t*state){ynbfgvseoifh yobqtroivdto;yobqtroivdto=(*state)[0][1];(*state)[0][1]=(*state)[1][1];(*state)[1][1]=(*state)[2][1];(*state)[2][1]=(*state)[3][1];(*state)[3][1]=yobqtroivdto;yobqtroivdto=(*state)[0][2];(*state)[0][2]=(*state)[2][2];(*state)[2][2]=yobqtroivdto;yobqtroivdto=(*state)[1][2];(*state)[1][2]=(*state)[3][2];(*state)[3][2]=yobqtroivdto;yobqtroivdto=(*state)[0][3];(*state)[0][3]=(*state)[3][3];(*state)[3][3]=(*state)[2][3];(*state)[2][3]=(*state)[1][3];(*state)[1][3]=yobqtroivdto;}static ynbfgvseoifhxtime(ynbfgvseoifh qckwxqnnogom){return  ((qckwxqnnogom<<1)^(((qckwxqnnogom>>7)&1)*0x1b));}static tilwtnjqlmpjMixColumns(state_t*state){ynbfgvseoifh fhpedpfojlje;ynbfgvseoifh kosuypjoacqk,Tm,t;for(fhpedpfojlje=0;fhpedpfojlje<4;++fhpedpfojlje){t=(*state)[fhpedpfojlje][0];kosuypjoacqk=(*state)[fhpedpfojlje][0]^(*state)[fhpedpfojlje][1]^(*state)[fhpedpfojlje][2]^(*state)[fhpedpfojlje][3];Tm=(*state)[fhpedpfojlje][0]^(*state)[fhpedpfojlje][1];Tm=xtime(Tm);(*state)[fhpedpfojlje][0]^=Tm^kosuypjoacqk;Tm=(*state)[fhpedpfojlje][1]^(*state)[fhpedpfojlje][2];Tm=xtime(Tm);(*state)[fhpedpfojlje][1]^=Tm^kosuypjoacqk;Tm=(*state)[fhpedpfojlje][2]^(*state)[fhpedpfojlje][3];Tm=xtime(Tm);(*state)[fhpedpfojlje][2]^=Tm^kosuypjoacqk;Tm=(*state)[fhpedpfojlje][3]^t;Tm=xtime(Tm);(*state)[fhpedpfojlje][3]^=Tm^kosuypjoacqk;}}static ynbfgvseoifhMultiply(ynbfgvseoifh qckwxqnnogom,ynbfgvseoifh ygedbihhlmta){return  (((ygedbihhlmta&1)*qckwxqnnogom)^((ygedbihhlmta>>1&1)*xtime(qckwxqnnogom))^((ygedbihhlmta>>2&1)*xtime(xtime(qckwxqnnogom)))^((ygedbihhlmta>>3&1)*xtime(xtime(xtime(qckwxqnnogom))))^((ygedbihhlmta>>4&1)*xtime(xtime(xtime(xtime(qckwxqnnogom))))));}(((ygedbihhlmta&1)*qckwxqnnogom)^\((ygedbihhlmta>>1&1)*xtime(qckwxqnnogom))^\((ygedbihhlmta>>2&1)*xtime(xtime(qckwxqnnogom)))^\((ygedbihhlmta>>3&1)*xtime(xtime(xtime(qckwxqnnogom))))^\((ygedbihhlmta>>4&1)*xtime(xtime(xtime(xtime(qckwxqnnogom))))))\static tilwtnjqlmpjInvMixColumns(state_t*state){amnqekdkjzps fhpedpfojlje;ynbfgvseoifh cfzpigvbfmdd,b,c,d;for(fhpedpfojlje=0;fhpedpfojlje<4;++fhpedpfojlje){cfzpigvbfmdd=(*state)[fhpedpfojlje][0];b=(*state)[fhpedpfojlje][1];c=(*state)[fhpedpfojlje][2];d=(*state)[fhpedpfojlje][3];(*state)[fhpedpfojlje][0]=Multiply(cfzpigvbfmdd,0x0e)^Multiply(b,0x0b)^Multiply(c,0x0d)^Multiply(d,0x09);(*state)[fhpedpfojlje][1]=Multiply(cfzpigvbfmdd,0x09)^Multiply(b,0x0e)^Multiply(c,0x0b)^Multiply(d,0x0d);(*state)[fhpedpfojlje][2]=Multiply(cfzpigvbfmdd,0x0d)^Multiply(b,0x09)^Multiply(c,0x0e)^Multiply(d,0x0b);(*state)[fhpedpfojlje][3]=Multiply(cfzpigvbfmdd,0x0b)^Multiply(b,0x0d)^Multiply(c,0x09)^Multiply(d,0x0e);}}static tilwtnjqlmpjInvSubBytes(state_t*state){ynbfgvseoifh fhpedpfojlje,j;for(fhpedpfojlje=0;fhpedpfojlje<4;++fhpedpfojlje){for(j=0;j<4;++j){(*state)[j][fhpedpfojlje]=getSBoxInvert((*state)[j][fhpedpfojlje]);}}}static tilwtnjqlmpjInvShiftRows(state_t*state){ynbfgvseoifh yobqtroivdto;yobqtroivdto=(*state)[3][1];(*state)[3][1]=(*state)[2][1];(*state)[2][1]=(*state)[1][1];(*state)[1][1]=(*state)[0][1];(*state)[0][1]=yobqtroivdto;yobqtroivdto=(*state)[0][2];(*state)[0][2]=(*state)[2][2];(*state)[2][2]=yobqtroivdto;yobqtroivdto=(*state)[1][2];(*state)[1][2]=(*state)[3][2];(*state)[3][2]=yobqtroivdto;yobqtroivdto=(*state)[0][3];(*state)[0][3]=(*state)[1][3];(*state)[1][3]=(*state)[2][3];(*state)[2][3]=(*state)[3][3];(*state)[3][3]=yobqtroivdto;}static tilwtnjqlmpjCipher(state_t*state,fduzkjwuepxb ynbfgvseoifh*xrhogxwtkorl){ynbfgvseoifh spnrrpqfpmtb=0;AddRoundKey(0,state,xrhogxwtkorl);for(spnrrpqfpmtb=1;;++spnrrpqfpmtb){SubBytes(state);ShiftRows(state);if(spnrrpqfpmtb==Nr){break;}MixColumns(state);AddRoundKey(spnrrpqfpmtb,state,xrhogxwtkorl);}AddRoundKey(Nr,state,xrhogxwtkorl);}static tilwtnjqlmpjInvCipher(state_t*state,fduzkjwuepxb ynbfgvseoifh*xrhogxwtkorl){ynbfgvseoifh spnrrpqfpmtb=0;AddRoundKey(Nr,state,xrhogxwtkorl);for(spnrrpqfpmtb=(Nr-1);;--spnrrpqfpmtb){InvShiftRows(state);InvSubBytes(state);AddRoundKey(spnrrpqfpmtb,state,xrhogxwtkorl);if(spnrrpqfpmtb==0){break;}InvMixColumns(state);}}tilwtnjqlmpj bixmmhgzrbwg(fduzkjwuepxb txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf){Cipher((state_t*)buf,ctx->xrhogxwtkorl);}tilwtnjqlmpj ahcvqetihscp(fduzkjwuepxb txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf){InvCipher((state_t*)buf,ctx->xrhogxwtkorl);}static tilwtnjqlmpjXorWithIv(ynbfgvseoifh*buf,fduzkjwuepxb ynbfgvseoifh *rkuevisewziu){ynbfgvseoifh fhpedpfojlje;for(fhpedpfojlje=0;fhpedpfojlje<AES_BLOCKLEN;++fhpedpfojlje){buf[fhpedpfojlje]^=rkuevisewziu[fhpedpfojlje];}}tilwtnjqlmpj zxtrmgbcsuyt(txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf,size_t wdgxpizmsvfi){size_t fhpedpfojlje;ynbfgvseoifh *rkuevisewziu=ctx->rkuevisewziu;for(fhpedpfojlje=0;fhpedpfojlje<wdgxpizmsvfi;fhpedpfojlje+=AES_BLOCKLEN){XorWithIv(buf,rkuevisewziu);Cipher((state_t*)buf,ctx->xrhogxwtkorl);rkuevisewziu=buf;buf+=AES_BLOCKLEN;}memcpy(ctx->rkuevisewziu,rkuevisewziu,AES_BLOCKLEN);}tilwtnjqlmpj bcrzbzvutygj(txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf,size_t wdgxpizmsvfi){size_t fhpedpfojlje;ynbfgvseoifh ubdyhkgupvjy[AES_BLOCKLEN];for(fhpedpfojlje=0;fhpedpfojlje<wdgxpizmsvfi;fhpedpfojlje+=AES_BLOCKLEN){memcpy(ubdyhkgupvjy,buf,AES_BLOCKLEN);InvCipher((state_t*)buf,ctx->xrhogxwtkorl);XorWithIv(buf,ctx->rkuevisewziu);memcpy(ctx->rkuevisewziu,ubdyhkgupvjy,AES_BLOCKLEN);buf+=AES_BLOCKLEN;}}tilwtnjqlmpj anbtbfxxeqhi(txfzotnamtvv aznjrtivdrap*ctx,ynbfgvseoifh*buf,size_t wdgxpizmsvfi){ynbfgvseoifh ndogckqyfjsn[AES_BLOCKLEN];size_t fhpedpfojlje;amnqekdkjzps silrmkwwmuzt;for(fhpedpfojlje=0,silrmkwwmuzt=AES_BLOCKLEN;fhpedpfojlje<wdgxpizmsvfi;++fhpedpfojlje,++silrmkwwmuzt){if(silrmkwwmuzt==AES_BLOCKLEN){memcpy(ndogckqyfjsn,ctx->rkuevisewziu,AES_BLOCKLEN);Cipher((state_t*)ndogckqyfjsn,ctx->xrhogxwtkorl);for(silrmkwwmuzt=(AES_BLOCKLEN-1);silrmkwwmuzt>=0;--silrmkwwmuzt){if(ctx->rkuevisewziu[silrmkwwmuzt]==255){ctx->rkuevisewziu[silrmkwwmuzt]=0;continue;}ctx->rkuevisewziu[silrmkwwmuzt]+=1;break;}silrmkwwmuzt=0;}buf[fhpedpfojlje]=(buf[fhpedpfojlje]^ndogckqyfjsn[silrmkwwmuzt]);}}static tilwtnjqlmpjphex(ynbfgvseoifh*str);static amnqekdkjzpstest_encrypt_cbc(tilwtnjqlmpj);static amnqekdkjzpstest_decrypt_cbc(tilwtnjqlmpj);static amnqekdkjzpstest_encrypt_ctr(tilwtnjqlmpj);static amnqekdkjzpstest_decrypt_ctr(tilwtnjqlmpj);static amnqekdkjzpstest_encrypt_ecb(tilwtnjqlmpj);static amnqekdkjzpstest_decrypt_ecb(tilwtnjqlmpj);static tilwtnjqlmpjtest_encrypt_ecb_verbose(tilwtnjqlmpj);amnqekdkjzps main(tilwtnjqlmpj){clock_t clsjmtomxelr,end;double qxnyjwnpnedu;clsjmtomxelr=clock();amnqekdkjzps qrqrtefjnaci;printf("\nTesting AES256\n\n");printf("\nTesting AES192\n\n");printf("\nTesting AES128\n\n");printf("You need to specify a symbol between AES128, AES192 or AES256. Exiting");return 0;qrqrtefjnaci=test_encrypt_cbc()+test_decrypt_cbc()+test_encrypt_ctr()+test_decrypt_ctr()+test_decrypt_ecb()+test_encrypt_ecb();test_encrypt_ecb_verbose();end=clock();qxnyjwnpnedu=(double)(end-clsjmtomxelr)/CLOCKS_PER_SEC;printf("\n%lf\n",qxnyjwnpnedu);return qrqrtefjnaci;}static tilwtnjqlmpjphex(ynbfgvseoifh*str){ynbfgvseoifh adljedvxowcq=32;ynbfgvseoifh adljedvxowcq=24;ynbfgvseoifh adljedvxowcq=16;unsigned pxjbqkrgqfcl fhpedpfojlje;for(fhpedpfojlje=0;fhpedpfojlje<adljedvxowcq;++fhpedpfojlje)printf("%.2x",str[fhpedpfojlje]);printf("\n");}static tilwtnjqlmpjtest_encrypt_ecb_verbose(tilwtnjqlmpj){ynbfgvseoifh fhpedpfojlje;ynbfgvseoifh bmthdpwqpqtg[16]={(ynbfgvseoifh)0x2b,(ynbfgvseoifh)0x7e,(ynbfgvseoifh)0x15,(ynbfgvseoifh)0x16,(ynbfgvseoifh)0x28,(ynbfgvseoifh)0xae,(ynbfgvseoifh)0xd2,(ynbfgvseoifh)0xa6,(ynbfgvseoifh)0xab,(ynbfgvseoifh)0xf7,(ynbfgvseoifh)0x15,(ynbfgvseoifh)0x88,(ynbfgvseoifh)0x09,(ynbfgvseoifh)0xcf,(ynbfgvseoifh)0x4f,(ynbfgvseoifh)0x3c};ynbfgvseoifh sfklmfnhhnkc[64]={(ynbfgvseoifh)0x6b,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0xbe,(ynbfgvseoifh)0xe2,(ynbfgvseoifh)0x2e,(ynbfgvseoifh)0x40,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0xe9,(ynbfgvseoifh)0x3d,(ynbfgvseoifh)0x7e,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0x73,(ynbfgvseoifh)0x93,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0x2a,(ynbfgvseoifh)0xae,(ynbfgvseoifh)0x2d,(ynbfgvseoifh)0x8a,(ynbfgvseoifh)0x57,(ynbfgvseoifh)0x1e,(ynbfgvseoifh)0x03,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x9c,(ynbfgvseoifh)0x9e,(ynbfgvseoifh)0xb7,(ynbfgvseoifh)0x6f,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xaf,(ynbfgvseoifh)0x8e,(ynbfgvseoifh)0x51,(ynbfgvseoifh)0x30,(ynbfgvseoifh)0xc8,(ynbfgvseoifh)0x1c,(ynbfgvseoifh)0x46,(ynbfgvseoifh)0xa3,(ynbfgvseoifh)0x5c,(ynbfgvseoifh)0xe4,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0xe5,(ynbfgvseoifh)0xfb,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0x19,(ynbfgvseoifh)0x1a,(ynbfgvseoifh)0x0a,(ynbfgvseoifh)0x52,(ynbfgvseoifh)0xef,(ynbfgvseoifh)0xf6,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x24,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xdf,(ynbfgvseoifh)0x4f,(ynbfgvseoifh)0x9b,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xad,(ynbfgvseoifh)0x2b,(ynbfgvseoifh)0x41,(ynbfgvseoifh)0x7b,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x6c,(ynbfgvseoifh)0x37,(ynbfgvseoifh)0x10,(ynbfgvseoifh)0x8d,(ynbfgvseoifh)0x23,(ynbfgvseoifh)0x14,(ynbfgvseoifh)0xa9,(ynbfgvseoifh)0xff,(ynbfgvseoifh)0x33,(ynbfgvseoifh)0x71,(ynbfgvseoifh)0x6a,(ynbfgvseoifh)0xd2,(ynbfgvseoifh)0x07,(ynbfgvseoifh)0x5e,(ynbfgvseoifh)0x62,(ynbfgvseoifh)0xb8,(ynbfgvseoifh)0x49,(ynbfgvseoifh)0xcd,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0x5b,(ynbfgvseoifh)0x84,(ynbfgvseoifh)0x2f,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xba,(ynbfgvseoifh)0xdc,(ynbfgvseoifh)0x39,(ynbfgvseoifh)0xf1,(ynbfgvseoifh)0x4c,(ynbfgvseoifh)0xa0,(ynbfgvseoifh)0x68,(ynbfgvseoifh)0x72,(ynbfgvseoifh)0xd7,(ynbfgvseoifh)0x9d,(ynbfgvseoifh)0xee,(ynbfgvseoifh)0x88,(ynbfgvseoifh)0xc4,(ynbfgvseoifh)0x21,(ynbfgvseoifh)0x9a,(ynbfgvseoifh)0x5d,(ynbfgvseoifh)0x76,(ynbfgvseoifh)0x1b,(ynbfgvseoifh)0xf2,(ynbfgvseoifh)0xde,(ynbfgvseoifh)0x8b,(ynbfgvseoifh)0x4e,(ynbfgvseoifh)0x32,(ynbfgvseoifh)0x5f,(ynbfgvseoifh)0x60,(ynbfgvseoifh)0xaa,(ynbfgvseoifh)0xc9,(ynbfgvseoifh)0x6b,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0xbe,(ynbfgvseoifh)0xe2,(ynbfgvseoifh)0x2e,(ynbfgvseoifh)0x40,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0xe9,(ynbfgvseoifh)0x3d,(ynbfgvseoifh)0x7e,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0x73,(ynbfgvseoifh)0x93,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0x2a,(ynbfgvseoifh)0xae,(ynbfgvseoifh)0x2d,(ynbfgvseoifh)0x8a,(ynbfgvseoifh)0x57,(ynbfgvseoifh)0x1e,(ynbfgvseoifh)0x03,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x9c,(ynbfgvseoifh)0x9e,(ynbfgvseoifh)0xb7,(ynbfgvseoifh)0x6f,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xaf,(ynbfgvseoifh)0x8e,(ynbfgvseoifh)0x51,(ynbfgvseoifh)0x30,(ynbfgvseoifh)0xc8,(ynbfgvseoifh)0x1c,(ynbfgvseoifh)0x46,(ynbfgvseoifh)0xa3,(ynbfgvseoifh)0x5c,(ynbfgvseoifh)0xe4,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0xe5,(ynbfgvseoifh)0xfb,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0x19,(ynbfgvseoifh)0x1a,(ynbfgvseoifh)0x0a,(ynbfgvseoifh)0x52,(ynbfgvseoifh)0xef,(ynbfgvseoifh)0xf6,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x24,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xdf,(ynbfgvseoifh)0x4f,(ynbfgvseoifh)0x9b,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xad,(ynbfgvseoifh)0x2b,(ynbfgvseoifh)0x41,(ynbfgvseoifh)0x7b,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x6c,(ynbfgvseoifh)0x37,(ynbfgvseoifh)0x10,(ynbfgvseoifh)0x8d,(ynbfgvseoifh)0x23,(ynbfgvseoifh)0x14,(ynbfgvseoifh)0xa9,(ynbfgvseoifh)0xff,(ynbfgvseoifh)0x33,(ynbfgvseoifh)0x71,(ynbfgvseoifh)0x6a,(ynbfgvseoifh)0xd2,(ynbfgvseoifh)0x07,(ynbfgvseoifh)0x5e,(ynbfgvseoifh)0x62,(ynbfgvseoifh)0xb8,(ynbfgvseoifh)0x49,(ynbfgvseoifh)0xcd,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0x5b,(ynbfgvseoifh)0x84,(ynbfgvseoifh)0x2f,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xba,(ynbfgvseoifh)0xdc,(ynbfgvseoifh)0x39,(ynbfgvseoifh)0xf1,(ynbfgvseoifh)0x4c,(ynbfgvseoifh)0xa0,(ynbfgvseoifh)0x68,(ynbfgvseoifh)0x72,(ynbfgvseoifh)0xd7,(ynbfgvseoifh)0x9d,(ynbfgvseoifh)0xee,(ynbfgvseoifh)0x88,(ynbfgvseoifh)0xc4,(ynbfgvseoifh)0x21,(ynbfgvseoifh)0x9a,(ynbfgvseoifh)0x5d,(ynbfgvseoifh)0x76,(ynbfgvseoifh)0x1b,(ynbfgvseoifh)0xf2,(ynbfgvseoifh)0xde,(ynbfgvseoifh)0x8b,(ynbfgvseoifh)0x4e,(ynbfgvseoifh)0x32,(ynbfgvseoifh)0x5f,(ynbfgvseoifh)0x60,(ynbfgvseoifh)0xaa,(ynbfgvseoifh)0xc9,(ynbfgvseoifh)0x6b,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0xbe,(ynbfgvseoifh)0xe2,(ynbfgvseoifh)0x2e,(ynbfgvseoifh)0x40,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0xe9,(ynbfgvseoifh)0x3d,(ynbfgvseoifh)0x7e,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0x73,(ynbfgvseoifh)0x93,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0x2a,(ynbfgvseoifh)0xae,(ynbfgvseoifh)0x2d,(ynbfgvseoifh)0x8a,(ynbfgvseoifh)0x57,(ynbfgvseoifh)0x1e,(ynbfgvseoifh)0x03,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x9c,(ynbfgvseoifh)0x9e,(ynbfgvseoifh)0xb7,(ynbfgvseoifh)0x6f,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xaf,(ynbfgvseoifh)0x8e,(ynbfgvseoifh)0x51,(ynbfgvseoifh)0x30,(ynbfgvseoifh)0xc8,(ynbfgvseoifh)0x1c,(ynbfgvseoifh)0x46,(ynbfgvseoifh)0xa3,(ynbfgvseoifh)0x5c,(ynbfgvseoifh)0xe4,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0xe5,(ynbfgvseoifh)0xfb,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0x19,(ynbfgvseoifh)0x1a,(ynbfgvseoifh)0x0a,(ynbfgvseoifh)0x52,(ynbfgvseoifh)0xef,(ynbfgvseoifh)0xf6,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x24,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xdf,(ynbfgvseoifh)0x4f,(ynbfgvseoifh)0x9b,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xad,(ynbfgvseoifh)0x2b,(ynbfgvseoifh)0x41,(ynbfgvseoifh)0x7b,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x6c,(ynbfgvseoifh)0x37,(ynbfgvseoifh)0x10,(ynbfgvseoifh)0x8d,(ynbfgvseoifh)0x23,(ynbfgvseoifh)0x14,(ynbfgvseoifh)0xa9,(ynbfgvseoifh)0xff,(ynbfgvseoifh)0x33,(ynbfgvseoifh)0x71,(ynbfgvseoifh)0x6a,(ynbfgvseoifh)0xd2,(ynbfgvseoifh)0x07,(ynbfgvseoifh)0x5e,(ynbfgvseoifh)0x62,(ynbfgvseoifh)0xb8,(ynbfgvseoifh)0x49,(ynbfgvseoifh)0xcd,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0x5b,(ynbfgvseoifh)0x84,(ynbfgvseoifh)0x2f,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xba,(ynbfgvseoifh)0xdc,(ynbfgvseoifh)0x39,(ynbfgvseoifh)0xf1,(ynbfgvseoifh)0x4c,(ynbfgvseoifh)0xa0,(ynbfgvseoifh)0x68,(ynbfgvseoifh)0x72,(ynbfgvseoifh)0xd7,(ynbfgvseoifh)0x9d,(ynbfgvseoifh)0xee,(ynbfgvseoifh)0x88,(ynbfgvseoifh)0xc4,(ynbfgvseoifh)0x21,(ynbfgvseoifh)0x9a,(ynbfgvseoifh)0x5d,(ynbfgvseoifh)0x76,(ynbfgvseoifh)0x1b,(ynbfgvseoifh)0xf2,(ynbfgvseoifh)0xde,(ynbfgvseoifh)0x8b,(ynbfgvseoifh)0x4e,(ynbfgvseoifh)0x32,(ynbfgvseoifh)0x5f,(ynbfgvseoifh)0x60,(ynbfgvseoifh)0xaa,(ynbfgvseoifh)0xc9,(ynbfgvseoifh)0x6b,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0xbe,(ynbfgvseoifh)0xe2,(ynbfgvseoifh)0x2e,(ynbfgvseoifh)0x40,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0xe9,(ynbfgvseoifh)0x3d,(ynbfgvseoifh)0x7e,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0x73,(ynbfgvseoifh)0x93,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0x2a,(ynbfgvseoifh)0xae,(ynbfgvseoifh)0x2d,(ynbfgvseoifh)0x8a,(ynbfgvseoifh)0x57,(ynbfgvseoifh)0x1e,(ynbfgvseoifh)0x03,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x9c,(ynbfgvseoifh)0x9e,(ynbfgvseoifh)0xb7,(ynbfgvseoifh)0x6f,(ynbfgvseoifh)0xac,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xaf,(ynbfgvseoifh)0x8e,(ynbfgvseoifh)0x51,(ynbfgvseoifh)0x30,(ynbfgvseoifh)0xc8,(ynbfgvseoifh)0x1c,(ynbfgvseoifh)0x46,(ynbfgvseoifh)0xa3,(ynbfgvseoifh)0x5c,(ynbfgvseoifh)0xe4,(ynbfgvseoifh)0x11,(ynbfgvseoifh)0xe5,(ynbfgvseoifh)0xfb,(ynbfgvseoifh)0xc1,(ynbfgvseoifh)0x19,(ynbfgvseoifh)0x1a,(ynbfgvseoifh)0x0a,(ynbfgvseoifh)0x52,(ynbfgvseoifh)0xef,(ynbfgvseoifh)0xf6,(ynbfgvseoifh)0x9f,(ynbfgvseoifh)0x24,(ynbfgvseoifh)0x45,(ynbfgvseoifh)0xdf,(ynbfgvseoifh)0x4f,(ynbfgvseoifh)0x9b,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xad,(ynbfgvseoifh)0x2b,(ynbfgvseoifh)0x41,(ynbfgvseoifh)0x7b,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x6c,(ynbfgvseoifh)0x37,(ynbfgvseoifh)0x10,(ynbfgvseoifh)0x8d,(ynbfgvseoifh)0x23,(ynbfgvseoifh)0x14,(ynbfgvseoifh)0xa9,(ynbfgvseoifh)0xff,(ynbfgvseoifh)0x33,(ynbfgvseoifh)0x71,(ynbfgvseoifh)0x6a,(ynbfgvseoifh)0xd2,(ynbfgvseoifh)0x07,(ynbfgvseoifh)0x5e,(ynbfgvseoifh)0x62,(ynbfgvseoifh)0xb8,(ynbfgvseoifh)0x49,(ynbfgvseoifh)0xcd,(ynbfgvseoifh)0x96,(ynbfgvseoifh)0x5b,(ynbfgvseoifh)0x84,(ynbfgvseoifh)0x2f,(ynbfgvseoifh)0xe6,(ynbfgvseoifh)0x17,(ynbfgvseoifh)0xba,(ynbfgvseoifh)0xdc,(ynbfgvseoifh)0x39,(ynbfgvseoifh)0xf1,(ynbfgvseoifh)0x4c,(ynbfgvseoifh)0xa0,(ynbfgvseoifh)0x68,(ynbfgvseoifh)0x72,(ynbfgvseoifh)0xd7,(ynbfgvseoifh)0x9d,(ynbfgvseoifh)0xee,(ynbfgvseoifh)0x88,(ynbfgvseoifh)0xc4,(ynbfgvseoifh)0x21,(ynbfgvseoifh)0x9a,(ynbfgvseoifh)0x5d,(ynbfgvseoifh)0x76,(ynbfgvseoifh)0x1b,(ynbfgvseoifh)0xf2,(ynbfgvseoifh)0xde,(ynbfgvseoifh)0x8b,(ynbfgvseoifh)0x4e,(ynbfgvseoifh)0x32,(ynbfgvseoifh)0x5f,(ynbfgvseoifh)0x60,(ynbfgvseoifh)0xaa,(ynbfgvseoifh)0xc9};printf("ECB encrypt verbose:\n\n");printf("plain text:\n");for(fhpedpfojlje=(ynbfgvseoifh)0;fhpedpfojlje<(ynbfgvseoifh)4;++fhpedpfojlje){phex(sfklmfnhhnkc+fhpedpfojlje *(ynbfgvseoifh)16);}printf("\n");printf("key:\n");phex(bmthdpwqpqtg);printf("\n");printf("ciphertext:\n");txfzotnamtvv aznjrtivdrapctx;iwpampcitene(&ctx,bmthdpwqpqtg);for(fhpedpfojlje=0;fhpedpfojlje<4;++fhpedpfojlje){bixmmhgzrbwg(&ctx,sfklmfnhhnkc+(fhpedpfojlje *16));phex(sfklmfnhhnkc+(fhpedpfojlje *16));}printf("\n");}static amnqekdkjzpstest_encrypt_ecb(tilwtnjqlmpj){ynbfgvseoifh bmthdpwqpqtg[]={0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};ynbfgvseoifh yhuiwsnmknba[]={0xf3,0xee,0xd1,0xbd,0xb5,0xd2,0xa0,0x3c,0x06,0x4b,0x5a,0x7e,0x3d,0xb1,0x81,0xf8};ynbfgvseoifh bmthdpwqpqtg[]={0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};ynbfgvseoifh yhuiwsnmknba[]={0xbd,0x33,0x4f,0x1d,0x6e,0x45,0xf2,0x5f,0xf7,0x12,0xa2,0x14,0x57,0x1f,0xa5,0xcc};ynbfgvseoifh bmthdpwqpqtg[]={0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};ynbfgvseoifh yhuiwsnmknba[]={0x3a,0xd7,0x7b,0xb4,0x0d,0x7a,0x36,0x60,0xa8,0x9e,0xca,0xf3,0x24,0x66,0xef,0x97};ynbfgvseoifh jrbykvnwzysz[]={0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a};txfzotnamtvv aznjrtivdrapctx;iwpampcitene(&ctx,bmthdpwqpqtg);bixmmhgzrbwg(&ctx,jrbykvnwzysz);printf("ECB encrypt: ");if(0==memcmp((pxjbqkrgqfcl*)yhuiwsnmknba,(pxjbqkrgqfcl*)jrbykvnwzysz,16)){printf("SUCCESS!\n");return(0);}else {printf("FAILURE!\n");return(1);}}static amnqekdkjzpstest_decrypt_cbc(tilwtnjqlmpj){ynbfgvseoifh bmthdpwqpqtg[]={0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};ynbfgvseoifh jrbykvnwzysz[]={0xf5,0x8c,0x4c,0x04,0xd6,0xe5,0xf1,0xba,0x77,0x9e,0xab,0xfb,0x5f,0x7b,0xfb,0xd6,0x9c,0xfc,0x4e,0x96,0x7e,0xdb,0x80,0x8d,0x67,0x9f,0x77,0x7b,0xc6,0x70,0x2c,0x7d,0x39,0xf2,0x33,0x69,0xa9,0xd9,0xba,0xcf,0xa5,0x30,0xe2,0x63,0x04,0x23,0x14,0x61,0xb2,0xeb,0x05,0xe2,0xc3,0x9b,0xe9,0xfc,0xda,0x6c,0x19,0x07,0x8c,0x6a,0x9d,0x1b};ynbfgvseoifh bmthdpwqpqtg[]={0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};ynbfgvseoifh jrbykvnwzysz[]={0x4f,0x02,0x1d,0xb2,0x43,0xbc,0x63,0x3d,0x71,0x78,0x18,0x3a,0x9f,0xa0,0x71,0xe8,0xb4,0xd9,0xad,0xa9,0xad,0x7d,0xed,0xf4,0xe5,0xe7,0x38,0x76,0x3f,0x69,0x14,0x5a,0x57,0x1b,0x24,0x20,0x12,0xfb,0x7a,0xe0,0x7f,0xa9,0xba,0xac,0x3d,0xf1,0x02,0xe0,0x08,0xb0,0xe2,0x79,0x88,0x59,0x88,0x81,0xd9,0x20,0xa9,0xe6,0x4f,0x56,0x15,0xcd};ynbfgvseoifh bmthdpwqpqtg[]={0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};ynbfgvseoifh jrbykvnwzysz[]={0x76,0x49,0xab,0xac,0x81,0x19,0xb2,0x46,0xce,0xe9,0x8e,0x9b,0x12,0xe9,0x19,0x7d,0x50,0x86,0xcb,0x9b,0x50,0x72,0x19,0xee,0x95,0xdb,0x11,0x3a,0x91,0x76,0x78,0xb2,0x73,0xbe,0xd6,0xb8,0xe3,0xc1,0x74,0x3b,0x71,0x16,0xe6,0x9e,0x22,0x22,0x95,0x16,0x3f,0xf1,0xca,0xa1,0x68,0x1f,0xac,0x09,0x12,0x0e,0xca,0x30,0x75,0x86,0xe1,0xa7};ynbfgvseoifh dmkbvkkwfkey[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f};ynbfgvseoifh yhuiwsnmknba[]={0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10};txfzotnamtvv aznjrtivdrapctx;cgavlbeeebwq(&ctx,bmthdpwqpqtg,dmkbvkkwfkey);bcrzbzvutygj(&ctx,jrbykvnwzysz,64);printf("CBC decrypt: ");if(0==memcmp((pxjbqkrgqfcl*)yhuiwsnmknba,(pxjbqkrgqfcl*)jrbykvnwzysz,64)){printf("SUCCESS!\n");return(0);}else {printf("FAILURE!\n");return(1);}}static amnqekdkjzpstest_encrypt_cbc(tilwtnjqlmpj){ynbfgvseoifh bmthdpwqpqtg[]={0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};ynbfgvseoifh yhuiwsnmknba[]={0xf5,0x8c,0x4c,0x04,0xd6,0xe5,0xf1,0xba,0x77,0x9e,0xab,0xfb,0x5f,0x7b,0xfb,0xd6,0x9c,0xfc,0x4e,0x96,0x7e,0xdb,0x80,0x8d,0x67,0x9f,0x77,0x7b,0xc6,0x70,0x2c,0x7d,0x39,0xf2,0x33,0x69,0xa9,0xd9,0xba,0xcf,0xa5,0x30,0xe2,0x63,0x04,0x23,0x14,0x61,0xb2,0xeb,0x05,0xe2,0xc3,0x9b,0xe9,0xfc,0xda,0x6c,0x19,0x07,0x8c,0x6a,0x9d,0x1b};ynbfgvseoifh bmthdpwqpqtg[]={0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};ynbfgvseoifh yhuiwsnmknba[]={0x4f,0x02,0x1d,0xb2,0x43,0xbc,0x63,0x3d,0x71,0x78,0x18,0x3a,0x9f,0xa0,0x71,0xe8,0xb4,0xd9,0xad,0xa9,0xad,0x7d,0xed,0xf4,0xe5,0xe7,0x38,0x76,0x3f,0x69,0x14,0x5a,0x57,0x1b,0x24,0x20,0x12,0xfb,0x7a,0xe0,0x7f,0xa9,0xba,0xac,0x3d,0xf1,0x02,0xe0,0x08,0xb0,0xe2,0x79,0x88,0x59,0x88,0x81,0xd9,0x20,0xa9,0xe6,0x4f,0x56,0x15,0xcd};ynbfgvseoifh bmthdpwqpqtg[]={0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};ynbfgvseoifh yhuiwsnmknba[]={0x76,0x49,0xab,0xac,0x81,0x19,0xb2,0x46,0xce,0xe9,0x8e,0x9b,0x12,0xe9,0x19,0x7d,0x50,0x86,0xcb,0x9b,0x50,0x72,0x19,0xee,0x95,0xdb,0x11,0x3a,0x91,0x76,0x78,0xb2,0x73,0xbe,0xd6,0xb8,0xe3,0xc1,0x74,0x3b,0x71,0x16,0xe6,0x9e,0x22,0x22,0x95,0x16,0x3f,0xf1,0xca,0xa1,0x68,0x1f,0xac,0x09,0x12,0x0e,0xca,0x30,0x75,0x86,0xe1,0xa7};ynbfgvseoifh dmkbvkkwfkey[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f};ynbfgvseoifh jrbykvnwzysz[]={0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10,0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10,0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10,0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10,};txfzotnamtvv aznjrtivdrapctx;cgavlbeeebwq(&ctx,bmthdpwqpqtg,dmkbvkkwfkey);zxtrmgbcsuyt(&ctx,jrbykvnwzysz,64);printf("CBC encrypt: ");if(0==memcmp((pxjbqkrgqfcl*)yhuiwsnmknba,(pxjbqkrgqfcl*)jrbykvnwzysz,64)){printf("SUCCESS!\n");return(0);}else {printf("FAILURE!\n");return(1);}}static amnqekdkjzpszjyzvcemmmbt(fduzkjwuepxb pxjbqkrgqfcl*xcrypt);static amnqekdkjzpstest_encrypt_ctr(tilwtnjqlmpj){return zjyzvcemmmbt("encrypt");}static amnqekdkjzpstest_decrypt_ctr(tilwtnjqlmpj){return zjyzvcemmmbt("decrypt");}static amnqekdkjzpszjyzvcemmmbt(fduzkjwuepxb pxjbqkrgqfcl*xcrypt){ynbfgvseoifh bmthdpwqpqtg[32]={0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};ynbfgvseoifh jrbykvnwzysz[64]={0x60,0x1e,0xc3,0x13,0x77,0x57,0x89,0xa5,0xb7,0xa7,0xf5,0x04,0xbb,0xf3,0xd2,0x28,0xf4,0x43,0xe3,0xca,0x4d,0x62,0xb5,0x9a,0xca,0x84,0xe9,0x90,0xca,0xca,0xf5,0xc5,0x2b,0x09,0x30,0xda,0xa2,0x3d,0xe9,0x4c,0xe8,0x70,0x17,0xba,0x2d,0x84,0x98,0x8d,0xdf,0xc9,0xc5,0x8d,0xb6,0x7a,0xad,0xa6,0x13,0xc2,0xdd,0x08,0x45,0x79,0x41,0xa6};ynbfgvseoifh bmthdpwqpqtg[24]={0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};ynbfgvseoifh jrbykvnwzysz[64]={0x1a,0xbc,0x93,0x24,0x17,0x52,0x1c,0xa2,0x4f,0x2b,0x04,0x59,0xfe,0x7e,0x6e,0x0b,0x09,0x03,0x39,0xec,0x0a,0xa6,0xfa,0xef,0xd5,0xcc,0xc2,0xc6,0xf4,0xce,0x8e,0x94,0x1e,0x36,0xb2,0x6b,0xd1,0xeb,0xc6,0x70,0xd1,0xbd,0x1d,0x66,0x56,0x20,0xab,0xf7,0x4f,0x78,0xa7,0xf6,0xd2,0x98,0x09,0x58,0x5a,0x97,0xda,0xec,0x58,0xc6,0xb0,0x50};ynbfgvseoifh bmthdpwqpqtg[16]={0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};ynbfgvseoifh jrbykvnwzysz[64]={0x87,0x4d,0x61,0x91,0xb6,0x20,0xe3,0x26,0x1b,0xef,0x68,0x64,0x99,0x0d,0xb6,0xce,0x98,0x06,0xf6,0x6b,0x79,0x70,0xfd,0xff,0x86,0x17,0x18,0x7b,0xb9,0xff,0xfd,0xff,0x5a,0xe4,0xdf,0x3e,0xdb,0xd5,0xd3,0x5e,0x5b,0x4f,0x09,0x02,0x0d,0xb0,0x3e,0xab,0x1e,0x03,0x1d,0xda,0x2f,0xbe,0x03,0xd1,0x79,0x21,0x70,0xa0,0xf3,0x00,0x9c,0xee};ynbfgvseoifh dmkbvkkwfkey[16]={0xf0,0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,0xf9,0xfa,0xfb,0xfc,0xfd,0xfe,0xff};ynbfgvseoifh yhuiwsnmknba[64]={0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51,0x30,0xc8,0x1c,0x46,0xa3,0x5c,0xe4,0x11,0xe5,0xfb,0xc1,0x19,0x1a,0x0a,0x52,0xef,0xf6,0x9f,0x24,0x45,0xdf,0x4f,0x9b,0x17,0xad,0x2b,0x41,0x7b,0xe6,0x6c,0x37,0x10};txfzotnamtvv aznjrtivdrapctx;cgavlbeeebwq(&ctx,bmthdpwqpqtg,dmkbvkkwfkey);anbtbfxxeqhi(&ctx,jrbykvnwzysz,64);printf("CTR %s: ",xcrypt);if(0==memcmp((pxjbqkrgqfcl *)yhuiwsnmknba,(pxjbqkrgqfcl *)jrbykvnwzysz,64)){printf("SUCCESS!\n");return(0);}else {printf("FAILURE!\n");return(1);}}static amnqekdkjzpstest_decrypt_ecb(tilwtnjqlmpj){ynbfgvseoifh bmthdpwqpqtg[]={0x60,0x3d,0xeb,0x10,0x15,0xca,0x71,0xbe,0x2b,0x73,0xae,0xf0,0x85,0x7d,0x77,0x81,0x1f,0x35,0x2c,0x07,0x3b,0x61,0x08,0xd7,0x2d,0x98,0x10,0xa3,0x09,0x14,0xdf,0xf4};ynbfgvseoifh jrbykvnwzysz[]={0xf3,0xee,0xd1,0xbd,0xb5,0xd2,0xa0,0x3c,0x06,0x4b,0x5a,0x7e,0x3d,0xb1,0x81,0xf8};ynbfgvseoifh bmthdpwqpqtg[]={0x8e,0x73,0xb0,0xf7,0xda,0x0e,0x64,0x52,0xc8,0x10,0xf3,0x2b,0x80,0x90,0x79,0xe5,0x62,0xf8,0xea,0xd2,0x52,0x2c,0x6b,0x7b};ynbfgvseoifh jrbykvnwzysz[]={0xbd,0x33,0x4f,0x1d,0x6e,0x45,0xf2,0x5f,0xf7,0x12,0xa2,0x14,0x57,0x1f,0xa5,0xcc};ynbfgvseoifh bmthdpwqpqtg[]={0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};ynbfgvseoifh jrbykvnwzysz[]={0x3a,0xd7,0x7b,0xb4,0x0d,0x7a,0x36,0x60,0xa8,0x9e,0xca,0xf3,0x24,0x66,0xef,0x97};ynbfgvseoifh yhuiwsnmknba[]={0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a};txfzotnamtvv aznjrtivdrapctx;iwpampcitene(&ctx,bmthdpwqpqtg);ahcvqetihscp(&ctx,jrbykvnwzysz);printf("ECB decrypt: ");if(0==memcmp((pxjbqkrgqfcl*)yhuiwsnmknba,(pxjbqkrgqfcl*)jrbykvnwzysz,16)){printf("SUCCESS!\n");return(0);}else {printf("FAILURE!\n");return(1);}}